{% extends "base.html" %}

{% block title %}PROCESSING // VIDEO SUMMARIZE{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    {% if job.metadata %}
    <div class="border-2 border-zinc-800 bg-zinc-950 p-4 mb-6 flex gap-4 items-center">
        <img src="{{ job.metadata.thumbnail }}" alt="" class="w-24 h-auto border-2 border-zinc-700 grayscale">
        <div>
            <h2 class="font-extrabold text-sm text-white uppercase leading-snug">{{ job.metadata.title }}</h2>
            <p class="text-zinc-600 text-xs mt-1 uppercase tracking-wider">{{ job.metadata.channel }}</p>
        </div>
    </div>
    {% endif %}

    <div class="brutal-box-electric bg-black p-6">
        <h2 class="text-xl font-extrabold uppercase mb-6 text-electric">
            <span class="blink">&gt;</span> PROCESSING
        </h2>

        <div class="space-y-4">
            <div id="stages" class="space-y-3 text-sm">
                <div id="stage-downloading" class="flex items-center gap-3 text-zinc-600">
                    <span class="font-bold w-6 text-center text-base" id="icon-downloading">-</span>
                    <span class="uppercase tracking-wider">DOWNLOAD AUDIO</span>
                </div>
                <div id="stage-transcribing" class="flex items-center gap-3 text-zinc-600">
                    <span class="font-bold w-6 text-center text-base" id="icon-transcribing">-</span>
                    <span class="uppercase tracking-wider">TRANSCRIBE</span>
                </div>
                <div id="stage-summarizing" class="flex items-center gap-3 text-zinc-600">
                    <span class="font-bold w-6 text-center text-base" id="icon-summarizing">-</span>
                    <span class="uppercase tracking-wider">SUMMARIZE</span>
                </div>
            </div>

            <div class="mt-6">
                <div class="flex justify-between text-xs uppercase tracking-wider text-zinc-500 mb-2">
                    <span id="stage-detail">starting...</span>
                    <span id="progress-pct" class="text-electric font-bold">0%</span>
                </div>
                <div class="w-full bg-zinc-900 h-4 border-2 border-zinc-700">
                    <div id="progress-bar" class="bg-electric h-full transition-all duration-300" style="width: 0%"></div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    initSSE('{{ job.id }}');
</script>
{% endblock %}
